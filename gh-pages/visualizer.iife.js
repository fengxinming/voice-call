var voiceCallPluginVisualizer=function(){"use strict";class t{constructor(t){this.analyser=null,this.state=0,this.opts=Object.assign({shape:"frequencyBars"},t);const e=document.createElement("canvas");e.style.width="100%",e.style.height="100%",t.width&&(e.width=t.width),t.height&&(e.height=t.height),this.canvas=e,this.canvasContext=e.getContext("2d"),this.mount(t.container)}mount(t){let e=t;if("string"==typeof t&&(e=document.querySelector(t)),!e)return void console.error("Could not mount non-el");const{canvas:n}=this;if(!n.width){const t=e.clientWidth;t&&(n.width=t)}if(!n.height){const t=e.clientHeight;t&&(n.height=t)}e.appendChild(this.canvas)}start({inputSource:t,audioContext:e}){const n=e.createAnalyser();n.minDecibels=-90,n.maxDecibels=-10,n.smoothingTimeConstant=.85,t.connect(n),this.analyser=n,this.state=1,this.draw()}stop(){this.state=0,this.analyser=null}dispose(){this.stop(),this.canvas.remove()}sineWaveRender(){const{analyser:t}=this;if(!t)return;t.fftSize=2048;const e=t.fftSize,n=new Uint8Array(e),{canvasContext:i,canvas:s}=this,{width:a,height:o}=s;i.clearRect(0,0,a,o);const r=()=>{if(!this.state)return void this.clean();requestAnimationFrame(r),t.getByteTimeDomainData(n),i.fillStyle="rgb(200, 200, 200)",i.fillRect(0,0,a,o),i.lineWidth=2,i.strokeStyle="rgb(0, 0, 0)",i.beginPath();const c=1*a/e;let h=0;for(let t=0;t<e;t++){const e=n[t]/128*o/2;0===t?i.moveTo(h,e):i.lineTo(h,e),h+=c}i.lineTo(s.width,s.height/2),i.stroke()};r()}frequencyBarsRender(){const{analyser:t}=this;if(!t)return;t.fftSize=256;const e=t.frequencyBinCount,n=new Uint8Array(e),{canvasContext:i}=this,{width:s,height:a}=this.canvas;i.clearRect(0,0,s,a);const o=()=>{if(!this.state)return void this.clean();requestAnimationFrame(o),t.getByteFrequencyData(n),i.fillStyle="rgb(0, 0, 0)",i.fillRect(0,0,s,a);const r=s/e*2.5;let c,h=0;for(let t=0;t<e;t++)c=n[t],i.fillStyle=`rgb(${c+100},50,50)`,i.fillRect(h,a-c/2,r,c/2),h+=r+1};o()}draw(){this[`${this.opts.shape}Render`]()}clean(){const{canvasContext:t}=this,{width:e,height:n}=this.canvas;t.clearRect(0,0,e,n)}}return function(e,n){const i=new t(n);e.on("start",(()=>{i.start(e)})),e.on("stop",(()=>{i.stop()})),e.on("dispose",(()=>{i.dispose()}))}}();
