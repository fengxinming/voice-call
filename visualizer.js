!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).voiceCallPluginVisualizer=e()}(this,(function(){"use strict";class t{constructor(t){this.analyser=null,this.state=0,this.opts=Object.assign({shape:"frequencyBars"},t);const e=document.createElement("canvas");e.style.width="100%",e.style.height="100%",t.width&&(e.width=t.width),t.height&&(e.height=t.height),this.canvas=e,this.canvasContext=e.getContext("2d"),this.mount(t.container)}mount(t){let e=t;if("string"==typeof t&&(e=document.querySelector(t)),!e)return void console.error("Could not mount non-el");const{canvas:n}=this;if(!n.width){const t=e.clientWidth;t&&(n.width=t)}if(!n.height){const t=e.clientHeight;t&&(n.height=t)}e.appendChild(this.canvas)}start({inputSource:t,audioContext:e}){const n=e.createAnalyser();n.minDecibels=-90,n.maxDecibels=-10,n.smoothingTimeConstant=.85,t.connect(n),this.analyser=n,this.state=1,this.draw()}stop(){this.state=0,this.analyser=null}dispose(){this.stop(),this.canvas.remove()}sineWaveRender(){const{analyser:t}=this;if(!t)return;t.fftSize=2048;const e=t.fftSize,n=new Uint8Array(e),{canvasContext:i,canvas:s}=this,{width:o,height:a}=s;i.clearRect(0,0,o,a);const c=()=>{if(!this.state)return void this.clean();requestAnimationFrame(c),t.getByteTimeDomainData(n),i.fillStyle="rgb(200, 200, 200)",i.fillRect(0,0,o,a),i.lineWidth=2,i.strokeStyle="rgb(0, 0, 0)",i.beginPath();const h=1*o/e;let r=0;for(let t=0;t<e;t++){const e=n[t]/128*a/2;0===t?i.moveTo(r,e):i.lineTo(r,e),r+=h}i.lineTo(s.width,s.height/2),i.stroke()};c()}frequencyBarsRender(){const{analyser:t}=this;if(!t)return;t.fftSize=256;const e=t.frequencyBinCount,n=new Uint8Array(e),{canvasContext:i}=this,{width:s,height:o}=this.canvas;i.clearRect(0,0,s,o);const a=()=>{if(!this.state)return void this.clean();requestAnimationFrame(a),t.getByteFrequencyData(n),i.fillStyle="rgb(0, 0, 0)",i.fillRect(0,0,s,o);const c=s/e*2.5;let h,r=0;for(let t=0;t<e;t++)h=n[t],i.fillStyle=`rgb(${h+100},50,50)`,i.fillRect(r,o-h/2,c,h/2),r+=c+1};a()}draw(){this[`${this.opts.shape}Render`]()}clean(){const{canvasContext:t}=this,{width:e,height:n}=this.canvas;t.clearRect(0,0,e,n)}}return function(e,n){const i=new t(n);e.on("start",(()=>{i.start(e)})),e.on("stop",(()=>{i.stop()})),e.on("dispose",(()=>{i.dispose()}))}}));
